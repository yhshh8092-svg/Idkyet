<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>robbing.homes</title>
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet" />
<style>
/* Your existing CSS remains unchanged for brevity, assume it's the same */
</style>
</head>
<body>
<div id="hidden-bg"></div>
<canvas id="bg"></canvas>

<div id="intro">
  <div class="menu glitch"><a href="#">robbing.homes</a></div>
</div>

<div id="main-page" style="display:none;">
  <h1>robbing.homes</h1>
  <div id="rows-container"></div>
</div>

<script>
const titles = [
  "r","ro","rob","robb","robbi","robbin","robbing",
  "robbing.","robbing.h","robbing.ho","robbing.hom",
  "robbing.home","robbing.homes","robbing.home",
  "robbing.hom","robbing.ho","robbing.h",
  "robbing.","robbing","robbin","robbi","robb","rob","ro","r"
];

let t=0; setInterval(()=>{document.title=titles[t]; t=(t+1)%titles.length;},200);

document.addEventListener('mousemove', e=>{
  const s=document.createElement('div');
  s.className='sparkle';
  s.style.left=e.pageX+'px';
  s.style.top=e.pageY+'px';
  document.body.appendChild(s);
  setTimeout(()=>s.remove(),500);
});

const intro=document.getElementById('intro');
const mainPage=document.getElementById('main-page');

const roster=[
  {name:'Violence', role:'Owner', img:'https://files.catbox.moe/fy0v6l.png', bio:'violence', profile:'#'},
  {name:'Phantom', role:'Co-Owner', img:'https://files.catbox.moe/63sdgg.png', bio:'snow leopard', profile:'#'}
];

intro.addEventListener('click', ()=>{
  intro.style.display='none';
  mainPage.style.display='block';
  loadRoster();
  startVisualizer();
});

function loadRoster() {
  const container=document.getElementById('rows-container');
  const row=document.createElement('div');
  row.className='row';
  roster.forEach(m=>{
    const card=document.createElement('div');
    card.className='flip-card';
    card.innerHTML=`
      <div class="flip-card-inner">
        <div class="flip-card-front">
          <img src="${m.img}">
          <span>${m.name}</span>
          <div class="role">${m.role}</div>
        </div>
        <div class="flip-card-back">${m.bio}</div>
      </div>`;
    card.onclick=()=>{window.location.href=m.profile;};
    row.appendChild(card);
  });
  container.appendChild(row);
}

async function startVisualizer() {
  const audioUrl='https://files.catbox.moe/wkdgui.mp3';
  const canvas=document.getElementById('bg');
  const ctx=canvas.getContext('2d');
  const hiddenBg=document.getElementById('hidden-bg');

  function resize() {
    canvas.width=window.innerWidth;
    canvas.height=window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
  const response=await fetch(audioUrl);
  const buffer=await response.arrayBuffer();
  const audioBuffer=await audioCtx.decodeAudioData(buffer);

  const source=audioCtx.createBufferSource();
  source.buffer=audioBuffer;

  const analyser=audioCtx.createAnalyser();
  analyser.fftSize=256;
  const data=new Uint8Array(analyser.frequencyBinCount);
  source.connect(analyser);
  analyser.connect(audioCtx.destination);
  source.start();

  const elems={
    body: document.body,
    menu: document.querySelector('.menu'),
    title: document.querySelector('h1'),
    imgs: document.querySelectorAll('img'),
    frontCards: document.querySelectorAll('.flip-card-front'),
    backCards: document.querySelectorAll('.flip-card-back')
  };

  function animate() {
    requestAnimationFrame(animate);
    analyser.getByteFrequencyData(data);

    const avg=data.reduce((a,b)=>a+b,0)/data.length;
    const bass=data.slice(0,15).reduce((a,b)=>a+b,0)/15;

    ctx.clearRect(0,0,canvas.width,canvas.height);
    const x=canvas.width/2;
    const y=canvas.height/2;
    const orbRadius=180+bass*2;
    const glow=Math.min(avg/100,1);
    const gradient=ctx.createRadialGradient(x,y,0,x,y,orbRadius);
    gradient.addColorStop(0,`rgba(255,30,30,${0.8*glow})`);
    gradient.addColorStop(0.6,`rgba(255,0,0,${0.3*glow})`);
    gradient.addColorStop(1,`rgba(0,0,0,0)`);
    ctx.fillStyle=gradient;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    hiddenBg.style.filter=`brightness(${Math.min(avg/50,1.8)}) blur(${8-Math.min(avg/80,6)}px)`;
    elems.body.style.background=`rgba(${bass*2},0,0,${Math.min(avg/300,0.3)})`;
    elems.menu.style.textShadow=`0 0 ${Math.min(avg/3,80)}px #ff0000`;

    elems.frontCards.forEach(c=>{
      c.style.boxShadow=`0 0 ${Math.min(bass/2,50)}px #ff0000`;
      c.style.borderColor=`rgba(255,${avg/2},${avg/4},1)`;
      c.style.filter=`brightness(${1+avg/200})`;
    });

    elems.backCards.forEach(c=>{
      c.style.boxShadow=`inset 0 0 ${Math.min(bass/2,50)}px #ff0000`;
      c.style.background=`rgba(${Math.min(bass*3,255)},0,0,${0.3+avg/400})`;
      c.style.borderColor=`rgba(255,${avg/2},${avg/4},1)`;
      c.style.filter=`brightness(${1+avg/250})`;
    });

    elems.imgs.forEach(img=>{
      img.style.filter=`drop-shadow(0 0 ${Math.min(avg/2,50)}px #ff0000)`;
    });

    if(elems.title){
      elems.title.style.textShadow=`0 0 ${Math.min(avg/3,50)}px #ff0000`;
    }
  }

  animate();
}
</script>
</body>
</html>
